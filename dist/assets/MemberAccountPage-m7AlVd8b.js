import{r as u,m as j,j as A,o as G,G as h,y as W,s as q,c as n,a as e,b as g,e as c,t as i,w,d as B,n as z,q as Y,F as E,g as L,K,f as T,h as o,I as H}from"./index-CanbGPVk.js";import{i as J,a as Q,b as X,F as Z}from"./index-BXs5ZZQj.js";import{d as tt}from"./DataService-z2Ih9ngB.js";import{R as et,M as at}from"./RoleSwitcher-BNbkLzKh.js";import{_ as st}from"./_plugin-vue_export-helper-DlAUqK2U.js";const rt={class:"container py-4 py-lg-5"},nt={class:"row"},ot={class:"col-12"},dt={class:"d-flex justify-content-between align-items-center mb-4"},it={class:"d-flex gap-2"},lt={class:"card"},ut={class:"card-header bg-light"},ct={class:"card-title mb-0"},mt={class:"card-body"},bt={key:0,class:"text-center py-4"},vt={key:1,class:"alert alert-warning",role:"alert"},gt={key:2,class:"text-center py-5"},pt={key:3},yt={class:"mb-4"},ht={class:"d-flex justify-content-between align-items-center mb-3"},ft={class:"d-flex gap-2"},xt={class:"row g-3"},_t={class:"card-body"},wt={class:"d-flex justify-content-between align-items-start mb-2"},kt={class:"card-title mb-1"},Ct={class:"text-muted small mb-2"},St={class:"mb-2"},Mt={class:"mt-1"},Dt={key:0,class:"mb-2"},Pt={class:"text-muted"},Rt={class:"d-flex gap-2 mt-3"},At=["onClick"],zt={class:"row g-4 mt-4"},Et={key:0,class:"col-md-3"},Lt={class:"card h-100 border-0 bg-success text-white"},Tt={class:"card-body text-center"},Vt={__name:"MemberAccountPage",setup($t){const k=q(),b=u({user:null,role:null,availableRoles:[]}),V=j(()=>(b.value.availableRoles||[]).includes("organizer")),d=u([]),f=u(!1),y=u(null),p=u("month"),x=u(null),_=u(new Map),C=["#0d6efd","#198754","#dc3545","#fd7e14","#6f42c1","#d63384","#20c997","#0dcaf0","#6c757d","#f8d7da"],S=u({plugins:[J,Q,X],initialView:"dayGridMonth",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek"},events:[],height:"auto",eventDisplay:"block",dayMaxEvents:3,eventClick:N});A(p,a=>{x.value&&x.value.getApi().changeView(a==="month"?"dayGridMonth":"timeGridWeek")}),A(d,()=>{F()},{deep:!0}),G(async()=>{const a=await h.getCurrentUser();b.value=a,a.user&&await D()});const M=h.onAuthStateChange(async(a,t)=>{if(a){const r=await h.getCurrentUser();b.value=r,await D()}else b.value={user:null,role:null,availableRoles:[]},d.value=[]});W(()=>{M&&M()});async function D(){if(b.value.user)try{f.value=!0,y.value=null;const a=await tt.getUserAppointments(b.value.user.email);d.value=a.appointments||[],$()}catch(a){console.error("Error loading appointments:",a),y.value=a.message||"Failed to load your programs."}finally{f.value=!1}}function $(){[...new Set(d.value.map(t=>t.program_id))].forEach((t,r)=>{_.value.has(t)||_.value.set(t,C[r%C.length])})}function P(a){return _.value.get(a)||"#0d6efd"}function F(){const a=[],t=new Date,r=new Date;r.setMonth(r.getMonth()+3),d.value.forEach(s=>{const m=P(s.program_id);s.time_slot.forEach(v=>{const U=I(v.day),l=new Date(t);for(l.setDate(l.getDate()+(U-l.getDay()+7)%7);l<=r;)a.push({title:s.program?.title||"Program",start:`${l.toISOString().split("T")[0]}T${v.start}:00`,end:`${l.toISOString().split("T")[0]}T${v.end}:00`,backgroundColor:m,borderColor:m,extendedProps:{appointmentId:s.id||s.appointment_id,programId:s.program_id,slot:v}}),l.setDate(l.getDate()+7)})}),S.value.events=a}function I(a){return{Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6}[a]||0}function N(a){const t=a.event.extendedProps.appointmentId,r=d.value.find(s=>s.id===t||s.appointment_id===t);r&&R(r)}function R(a){k.push({name:"member-appointment",params:{programId:a.program_id},query:{edit:a.id||a.appointment_id}})}async function O(){try{await h.logout(),k.push({name:"home"})}catch(a){console.error("Logout error:",a)}}return(a,t)=>{const r=B("RouterLink");return o(),n("div",rt,[e("div",nt,[e("div",ot,[e("div",dt,[t[3]||(t[3]=e("div",null,[e("h1",{class:"h3 mb-1"},"Member Dashboard"),e("p",{class:"text-muted mb-0"},"Manage your sports activities and programs")],-1)),e("div",it,[g(et),e("button",{onClick:O,class:"btn btn-outline-secondary"},[...t[2]||(t[2]=[e("i",{class:"bi bi-box-arrow-right me-2","aria-hidden":"true"},null,-1),c(" Logout ",-1)])])])]),g(at),e("div",lt,[e("div",ut,[e("h5",ct,[t[4]||(t[4]=e("i",{class:"bi bi-calendar-event me-2","aria-hidden":"true"},null,-1)),c(" My Programs ("+i(d.value.length)+") ",1)])]),e("div",mt,[f.value?(o(),n("div",bt,[...t[5]||(t[5]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading your programs...")],-1),e("p",{class:"mt-2 mb-0 text-muted"},"Loading your programs...",-1)])])):y.value?(o(),n("div",vt,[t[6]||(t[6]=e("i",{class:"bi bi-exclamation-triangle me-2"},null,-1)),c(" "+i(y.value),1)])):d.value.length===0?(o(),n("div",gt,[t[8]||(t[8]=e("i",{class:"bi bi-calendar-plus display-4 text-muted mb-3","aria-hidden":"true"},null,-1)),t[9]||(t[9]=e("h6",{class:"text-muted mb-3"},"No Programs Yet",-1)),t[10]||(t[10]=e("p",{class:"text-muted mb-4"}," You haven't joined any programs yet. Start exploring and join programs that interest you! ",-1)),g(r,{to:{name:"find"},class:"btn btn-primary"},{default:w(()=>[...t[7]||(t[7]=[e("i",{class:"bi bi-search me-2","aria-hidden":"true"},null,-1),c(" Find Sports Programs ",-1)])]),_:1})])):(o(),n("div",pt,[e("div",yt,[e("div",ht,[t[11]||(t[11]=e("h6",{class:"mb-0"},"Calendar View",-1)),e("div",ft,[e("button",{onClick:t[0]||(t[0]=s=>p.value="month"),class:z(["btn btn-sm",p.value==="month"?"btn-primary":"btn-outline-primary"])}," Month ",2),e("button",{onClick:t[1]||(t[1]=s=>p.value="week"),class:z(["btn btn-sm",p.value==="week"?"btn-primary":"btn-outline-primary"])}," Week ",2)])]),g(Y(Z),{ref_key:"calendarRef",ref:x,options:S.value},null,8,["options"])]),e("div",xt,[(o(!0),n(E,null,L(d.value,s=>(o(),n("div",{key:s.id||s.appointment_id,class:"col-md-6"},[e("div",{class:"card border-0",style:H({borderLeft:`4px solid ${P(s.program_id)}`})},[e("div",_t,[e("div",wt,[e("h6",kt,i(s.program?.title||"Unknown Program"),1),t[12]||(t[12]=e("span",{class:"badge bg-success"},"Active",-1))]),e("p",Ct,i(s.program?.sport||"Unknown Sport"),1),e("div",St,[t[13]||(t[13]=e("strong",null,"Time Slots:",-1)),e("div",Mt,[(o(!0),n(E,null,L(s.time_slot,(m,v)=>(o(),n("span",{key:v,class:"badge bg-light text-dark me-1 mb-1"},i(m.day)+"s "+i(m.start)+" - "+i(m.end),1))),128))])]),s.program?.venue?(o(),n("div",Dt,[e("small",Pt,[t[14]||(t[14]=e("i",{class:"bi bi-geo-alt me-1"},null,-1)),c(" "+i(s.program.venue.name)+", "+i(s.program.venue.suburb),1)])])):T("",!0),e("div",Rt,[e("button",{onClick:m=>R(s),class:"btn btn-sm btn-outline-primary"},[...t[15]||(t[15]=[e("i",{class:"bi bi-pencil me-1"},null,-1),c("Edit Times ",-1)])],8,At),g(r,{to:{name:"program",params:{id:s.program_id}},class:"btn btn-sm btn-outline-secondary"},{default:w(()=>[...t[16]||(t[16]=[e("i",{class:"bi bi-eye me-1"},null,-1),c("View Program ",-1)])]),_:2},1032,["to"])])])],4)]))),128))])]))])]),e("div",zt,[t[21]||(t[21]=K('<div class="col-md-3" data-v-6b173d1d><div class="card h-100 border-0 bg-light" data-v-6b173d1d><div class="card-body text-center" data-v-6b173d1d><i class="bi bi-heart text-primary mb-3" style="font-size:2rem;" aria-hidden="true" data-v-6b173d1d></i><h6 class="card-title" data-v-6b173d1d>Favorites</h6><p class="card-text text-muted small" data-v-6b173d1d>Your saved programs and activities</p><button class="btn btn-outline-primary btn-sm" disabled data-v-6b173d1d> Coming Soon </button></div></div></div><div class="col-md-3" data-v-6b173d1d><div class="card h-100 border-0 bg-light" data-v-6b173d1d><div class="card-body text-center" data-v-6b173d1d><i class="bi bi-star text-primary mb-3" style="font-size:2rem;" aria-hidden="true" data-v-6b173d1d></i><h6 class="card-title" data-v-6b173d1d>Reviews</h6><p class="card-text text-muted small" data-v-6b173d1d>Rate and review programs you&#39;ve joined</p><button class="btn btn-outline-primary btn-sm" disabled data-v-6b173d1d> Coming Soon </button></div></div></div><div class="col-md-3" data-v-6b173d1d><div class="card h-100 border-0 bg-light" data-v-6b173d1d><div class="card-body text-center" data-v-6b173d1d><i class="bi bi-bell text-primary mb-3" style="font-size:2rem;" aria-hidden="true" data-v-6b173d1d></i><h6 class="card-title" data-v-6b173d1d>Notifications</h6><p class="card-text text-muted small" data-v-6b173d1d>Program updates and reminders</p><button class="btn btn-outline-primary btn-sm" disabled data-v-6b173d1d> Coming Soon </button></div></div></div>',3)),V.value?T("",!0):(o(),n("div",Et,[e("div",Lt,[e("div",Tt,[t[18]||(t[18]=e("i",{class:"bi bi-people text-white mb-3",style:{"font-size":"2rem"},"aria-hidden":"true"},null,-1)),t[19]||(t[19]=e("h6",{class:"card-title"},"Become Organizer",-1)),t[20]||(t[20]=e("p",{class:"card-text small"},"Create and manage sports programs",-1)),g(r,{to:{name:"register"},class:"btn btn-light btn-sm"},{default:w(()=>[...t[17]||(t[17]=[c(" Add Organizer Role ",-1)])]),_:1})])])]))])])])])}}},jt=st(Vt,[["__scopeId","data-v-6b173d1d"]]);export{jt as default};
