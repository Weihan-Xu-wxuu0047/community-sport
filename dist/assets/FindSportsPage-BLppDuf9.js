import{i as N,r as v,j as F,o as E,c as r,a as t,f as k,k as w,v as B,l as V,F as q,g as C,t as d,n as Q,h as o,m as x,b as S,e as O,u as T,p as L,q as U,s as j}from"./index-CanbGPVk.js";import{a as D,_ as I}from"./ProgramCard-DRo14RWZ.js";import{d as P}from"./DataService-z2Ih9ngB.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"card mb-4"},W={class:"card-body"},Y={class:"mb-3"},J={class:"row g-3 mb-3"},K={class:"col-md-6 col-lg-3"},X=["value"],Z={class:"col-md-6 col-lg-3"},ee=["value"],te={class:"col-md-6 col-lg-3"},se={key:0,class:"invalid-feedback"},le={class:"mb-3"},ae={class:"row row-cols-1 row-cols-md-2 row-cols-lg-3 g-2"},re={class:"form-check"},oe=["id","checked","onChange"],ie=["for"],ne={key:0,class:"alert alert-warning",role:"alert"},ue={__name:"FiltersPanel",props:{initialQuery:{type:String,default:""}},emits:["filtersChanged"],setup(p,{expose:g,emit:b}){const i=p,h=b,l=N({query:i.initialQuery,sport:"",ageGroup:"",maxCost:"",accessibility:[]}),f=v([]),n=v([]),m=v([]),_=v(!0);F(()=>i.initialQuery,a=>{a&&a!==l.query&&(l.query=a)},{immediate:!0}),E(async()=>{try{_.value=!0;const[a,e,s]=await Promise.all([P.getSportOptions(),P.getAgeGroupOptions(),P.getAccessibilityOptions()]);f.value=a,n.value=e,m.value=s}catch(a){console.error("Error loading filter options:",a),f.value=["Basketball","Yoga","Running","Swimming"],n.value=["8-12","12-17","18-40","40-60","60+"],m.value=[{value:"wheelchair-access",label:"Wheelchair accessible"},{value:"accessible-toilets",label:"Accessible toilets"},{value:"pool-lift",label:"Pool lift"},{value:"family-change-rooms",label:"Family change rooms"},{value:"quiet-area",label:"Quiet area"},{value:"pet-friendly",label:"Pet friendly"}]}finally{_.value=!1}});const c=N({maxCost:"",general:""});function u(){const a=String(l.maxCost||"").trim();return a&&(isNaN(a)||parseFloat(a)<0)?(c.maxCost="Maximum cost must be a positive number",!1):(c.maxCost="",!0)}function y(){const a=l.query.trim().length>0,e=l.sport||l.ageGroup||String(l.maxCost||"").trim()||l.accessibility.length>0;return!a&&!e?(c.general="Please enter a search term or select at least one filter",!1):(c.general="",!0)}F(()=>({...l}),()=>{u(),y(),h("filtersChanged",{...l})},{deep:!0});function A(a){const e=l.accessibility.indexOf(a);e>-1?l.accessibility.splice(e,1):l.accessibility.push(a)}function G(){l.query="",l.sport="",l.ageGroup="",l.maxCost="",l.accessibility=[],c.maxCost="",c.general=""}function M(a){l.query=a}return g({updateQuery:M}),(a,e)=>(o(),r("div",H,[e[11]||(e[11]=t("div",{class:"card-header"},[t("h3",{class:"h5 mb-0"},"Search & Filters")],-1)),t("div",W,[t("div",Y,[e[4]||(e[4]=t("label",{for:"search-query",class:"form-label"},"Search",-1)),w(t("input",{id:"search-query","onUpdate:modelValue":e[0]||(e[0]=s=>l.query=s),type:"search",class:"form-control",placeholder:"Try 'youth', 'basketball', 'free'..."},null,512),[[B,l.query,void 0,{trim:!0}]])]),t("div",J,[t("div",K,[e[6]||(e[6]=t("label",{for:"sport-filter",class:"form-label"},"Sport",-1)),w(t("select",{id:"sport-filter","onUpdate:modelValue":e[1]||(e[1]=s=>l.sport=s),class:"form-select"},[e[5]||(e[5]=t("option",{value:""},"Any sport",-1)),(o(!0),r(q,null,C(f.value,s=>(o(),r("option",{key:s,value:s},d(s),9,X))),128))],512),[[V,l.sport]])]),t("div",Z,[e[8]||(e[8]=t("label",{for:"age-filter",class:"form-label"},"Age Group",-1)),w(t("select",{id:"age-filter","onUpdate:modelValue":e[2]||(e[2]=s=>l.ageGroup=s),class:"form-select"},[e[7]||(e[7]=t("option",{value:""},"Any age",-1)),(o(!0),r(q,null,C(n.value,s=>(o(),r("option",{key:s,value:s},d(s)+" years ",9,ee))),128))],512),[[V,l.ageGroup]])]),t("div",te,[e[9]||(e[9]=t("label",{for:"cost-filter",class:"form-label"},"Max Cost ($)",-1)),w(t("input",{id:"cost-filter","onUpdate:modelValue":e[3]||(e[3]=s=>l.maxCost=s),type:"number",min:"0",step:"0.01",class:Q(["form-control",{"is-invalid":c.maxCost}]),placeholder:"e.g. 15",onBlur:u},null,34),[[B,l.maxCost,void 0,{trim:!0}]]),c.maxCost?(o(),r("div",se,d(c.maxCost),1)):k("",!0)]),t("div",{class:"col-md-6 col-lg-3 d-flex align-items-end"},[t("button",{type:"button",class:"btn btn-outline-secondary w-100",onClick:G}," Clear All ")])]),t("div",le,[t("fieldset",null,[e[10]||(e[10]=t("legend",{class:"form-label"},"Accessibility Features",-1)),t("div",ae,[(o(!0),r(q,null,C(m.value,s=>(o(),r("div",{key:s.value,class:"col"},[t("div",re,[t("input",{id:`acc-${s.value}`,type:"checkbox",class:"form-check-input",checked:l.accessibility.includes(s.value),onChange:R=>A(s.value)},null,40,oe),t("label",{for:`acc-${s.value}`,class:"form-check-label"},d(s.label),9,ie)])]))),128))])])]),c.general?(o(),r("div",ne,d(c.general),1)):k("",!0)])]))}},ce=z(ue,[["__scopeId","data-v-14512d46"]]),de={id:"results-header",class:"d-flex justify-content-between align-items-center mb-3"},me={class:"h5 mb-1"},ve={key:0,class:"text-muted small mb-0"},ge={key:0,class:"d-flex align-items-center gap-2"},fe=["value"],pe={key:0,class:"text-center py-4"},ye={key:1,class:"text-center py-5"},be={key:2},he={class:"row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3 mb-4"},_e={key:0,"aria-label":"Search results pagination"},xe={class:"d-flex justify-content-between align-items-center"},ke=["disabled"],qe={class:"d-flex align-items-center gap-2"},Ce=["onClick"],$e={key:0,class:"text-muted"},we=["disabled"],$=10,Pe={__name:"ResultsList",props:{programs:{type:Array,required:!0},loading:{type:Boolean,default:!1}},setup(p){const g=p,b=v("relevance"),i=v(1),h=[{value:"relevance",label:"Most relevant"},{value:"cost-asc",label:"Lowest cost first"},{value:"cost-desc",label:"Highest cost first"},{value:"title",label:"Alphabetical"}],l=x(()=>{const a=[...g.programs];switch(b.value){case"cost-asc":return a.sort((e,s)=>e.cost-s.cost);case"cost-desc":return a.sort((e,s)=>s.cost-e.cost);case"title":return a.sort((e,s)=>e.title.localeCompare(s.title));case"relevance":default:return a}}),f=x(()=>{const a=(i.value-1)*$,e=a+$;return l.value.slice(a,e)}),n=x(()=>Math.ceil(l.value.length/$)),m=x(()=>i.value<n.value),_=x(()=>i.value>1);function c(a){a>=1&&a<=n.value&&(i.value=a,document.getElementById("results-header")?.scrollIntoView({behavior:"smooth"}))}function u(){m.value&&c(i.value+1)}function y(){_.value&&c(i.value-1)}function A(){i.value=1}F(()=>g.programs.length,A);const G=x(()=>l.value.length===0?0:(i.value-1)*$+1),M=x(()=>Math.min(i.value*$,l.value.length));return(a,e)=>(o(),r("div",null,[t("div",de,[t("div",null,[t("h2",me,d(p.loading?"Searching...":`${l.value.length} programs found`),1),!p.loading&&l.value.length>0?(o(),r("p",ve," Showing "+d(G.value)+"-"+d(M.value)+" of "+d(l.value.length),1)):k("",!0)]),!p.loading&&l.value.length>0?(o(),r("div",ge,[e[1]||(e[1]=t("label",{for:"sort-select",class:"form-label small mb-0"},"Sort by:",-1)),w(t("select",{id:"sort-select","onUpdate:modelValue":e[0]||(e[0]=s=>b.value=s),class:"form-select form-select-sm",style:{width:"auto"}},[(o(),r(q,null,C(h,s=>t("option",{key:s.value,value:s.value},d(s.label),9,fe)),64))],512),[[V,b.value]])])):k("",!0)]),p.loading?(o(),r("div",pe,[...e[2]||(e[2]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading programs...")],-1)])])):l.value.length===0?(o(),r("div",ye,[...e[3]||(e[3]=[t("i",{class:"bi bi-search text-muted",style:{"font-size":"3rem"},"aria-hidden":"true"},null,-1),t("h3",{class:"h5 mt-3 mb-2"},"No programs found",-1),t("p",{class:"text-muted mb-3"}," Try adjusting your search criteria or clearing some filters. ",-1)])])):(o(),r("div",be,[t("div",he,[(o(!0),r(q,null,C(f.value,s=>(o(),r("div",{key:s.id,class:"col"},[S(D,{program:s},null,8,["program"])]))),128))]),n.value>1?(o(),r("nav",_e,[t("div",xe,[t("button",{class:"btn btn-outline-primary",disabled:!_.value,onClick:y},[...e[4]||(e[4]=[t("i",{class:"bi bi-chevron-left","aria-hidden":"true"},null,-1),O(" Previous ",-1)])],8,ke),t("div",qe,[(o(!0),r(q,null,C(Math.min(n.value,5),s=>(o(),r("button",{key:s,class:Q(["btn btn-sm",s===i.value?"btn-primary":"btn-outline-secondary"]),onClick:R=>c(s)},d(s),11,Ce))),128)),n.value>5?(o(),r("span",$e," ... "+d(n.value),1)):k("",!0)]),t("button",{class:"btn btn-outline-primary",disabled:!m.value,onClick:u},[...e[5]||(e[5]=[O(" Next ",-1),t("i",{class:"bi bi-chevron-right","aria-hidden":"true"},null,-1)])],8,we)])])):k("",!0)]))]))}},Se={class:"container py-4 py-lg-5"},Fe={class:"row mb-4"},Ae={class:"col-12 col-lg-4"},Be={__name:"FindSportsPage",setup(p){const g=T(),b=j(),i=v(null),h=v(!1),l=v([]),f=v([]),n=v({query:"",sport:"",ageGroup:"",maxCost:"",accessibility:[]});E(async()=>{try{if(l.value=await P.getPrograms(),g.query.q){const u=String(g.query.q);n.value.query=u,await L(),i.value&&i.value.updateQuery(u),await m()}}catch(u){console.error("Error loading programs:",u)}});async function m(){try{h.value=!0,f.value=await P.searchPrograms(n.value)}catch(u){console.error("Error searching programs:",u),f.value=[]}finally{h.value=!1}}async function _(u){n.value={...n.value,...u};const y=n.value.query?{q:n.value.query}:{};b.replace({name:"find",query:y}),await m()}async function c(u){n.value.query=u,i.value&&i.value.updateQuery(u),await m()}return F(()=>g.query.q,async u=>{u&&u!==n.value.query&&(n.value.query=String(u),i.value&&i.value.updateQuery(n.value.query),await m())}),(u,y)=>(o(),r("div",Se,[t("div",Fe,[y[0]||(y[0]=t("div",{class:"col-12 col-lg-8"},[t("h1",{class:"h3 mb-2"},"Find Sports Programs"),t("p",{class:"text-muted mb-3"}," Discover inclusive, accessible community sport programs across Melbourne. ")],-1)),t("div",Ae,[S(I,{placeholder:"Search programs, sports, or features...",onSubmit:c})])]),S(ce,{ref_key:"filtersPanelRef",ref:i,"initial-query":U(g).query.q||"",onFiltersChanged:_},null,8,["initial-query"]),S(Pe,{programs:f.value,loading:h.value},null,8,["programs","loading"])]))}};export{Be as default};
